## Task 1

| Требования | Kubernetes | Docker Swarm | Nomad | OpenShift |
| :---: | :---: | :---: | :---: | :---: |
| Поддержка контейнеров | Да | Да, но только Docker | Да | Да |
| Обнаружение сервисов и маршрутизация запросов | Да, с использованием встроенного DNS-сервера | Да, с использованием встроенного DNS-сервера | Да, с 05.2022 есть встроенная поддержка, ранее только с Consul | Да, с использованием DNS Operator |
| Возможность горизонтального масштабирования | + | + | + | + |
| Возможность автоматического масштабирования | Да, горизонтальное и вертикальное | Нет, только вручную через `docker service scale` | Да, горизонтальное и вертикальное | Да, горизонтальное и вертикальное |
| Явное разделение ресурсов доступных извне и внутри системы | Да, доступ извне через `Services` изоляция внутри и снаружи обеспечивается через `Namespaces` | Да, `publish` для доступа извне, `overlay network` для разграничения внутри swarm | Да | Да |
| Конфигурирование приложения с помощью переменных среды | + | + | + | + |
| Безопасное хранение чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п | Да | Да, `docker secret` | Нет, только с использованием сторонних сервисов, [например Vault](https://www.nomadproject.io/docs/integrations/vault-integration) | Да |

По хорошему следует выбрать самый `хайповый` продукт - из рассмотренных это, вероятнее всего, `Kubernetes`, так как он на слуху, а это значит что есть много всего: документация, специалисты, комьюнити и тому подобное.  
Однако, это не значит, что другие решения не заслуживают рассмотрения:
* `Docker Swarm` проще остальных в развёртывании и настройке, а следовательно выгоден для небольшых сервисов, обучения или разработки локально. Так же к плюсам можно добавить нативное использование `docker-compose` файлов и простую миграцию на `Kubernetes`, в случае роста требовоний к оркестратору.
* `Nomad` выгоден если компания широко использует продукты HashiCorp и придерживается их философии - продукты должны быть просты, модульны, хорошо интегрируемы. Так же он обещает бо́льшую (в сравнении с `Kubernetes`) производительность за счёт компактности и меньшей "комбайности". 
* Стоит рассмотреть и `OpenShift`, если компания готова инвестировать в более удобный (но более сложный в освоении) вариант `Kubernetes` с дополнительными интегрированными инструментами из коробки (такими как `мониторинг`, `CI/CD`, `визуализацию логов` и `storage`).

## Task 2

Полный деплой кластера в y.cloud через terraform, ansible и docker ([source](src/)):
* terraform:
  * поднимает 3 вм-ки на alma-linux 9;
  * собирает inventory для ansible;
  * запускает playbook по собранному inventory;
* ansible:
  * ставит необходимые утилиты;
  * конфигурирует хосты (swapoff, отключение selinux, etc);
  * деплоит docker-compose, запускает его
  * ставит redis-cli и конфигурирует кластер через него

Вывод tf и проверка корректности реплицирования (для первой ноды указан адрес 172.18.0.3, так как она myself):
```bash
internal_ip_address_redis-01 = "192.168.101.6"
internal_ip_address_redis-02 = "192.168.101.31"
internal_ip_address_redis-03 = "192.168.101.27"
------
[root@redis-01 ~]# redis-cli -h 192.168.101.6 -p 6379 cluster nodes
ddd025d7a5a1ccc4528aaf05b53aa6d3b70d882a 192.168.101.27:6379@16379 master - 0 1678757673164 3 connected 10923-16383
27ec78f324d70b65537936b4aa1c61ee2cb89021 172.18.0.1:6380@16380 slave 19248f5005807ae04a0ac245ca21a443e51937c1 0 1678757672158 2 connected
f6940f93553793a3f4d552667efc21314a74721d 192.168.101.27:6380@16380 slave 1955027d8654b6c9ec25f56db1b801a1e9eaba8e 0 1678757672000 1 connected
fff7b7da3de2270da2a1639f50fa9087013b0f94 192.168.101.31:6380@16380 slave ddd025d7a5a1ccc4528aaf05b53aa6d3b70d882a 0 1678757674167 3 connected
1955027d8654b6c9ec25f56db1b801a1e9eaba8e 172.18.0.3:6379@16379 myself,master - 0 1678757672000 1 connected 0-5460
19248f5005807ae04a0ac245ca21a443e51937c1 192.168.101.31:6379@16379 master - 0 1678757671155 2 connected 5461-10922
```

По факту для деплоя достаточно только указать переменные в [variables.tf](src/terraform/variables.tf) и запустить `terraform init && terraform plan`.